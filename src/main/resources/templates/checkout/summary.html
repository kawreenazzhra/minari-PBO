<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>MINARI - Checkout</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link
        href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Poppins:wght@300;400;500&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" th:href="@{/css/style5.css}">
    <link rel="stylesheet" th:href="@{/css/navbar.css}">
    <style>
        .checkout-header {
            background: linear-gradient(90deg, #D4A59A 0%, #E8C3BC 100%);
            /* Pink/Beige gradient */
            padding: 40px 0;
            text-align: center;
            color: #1D1B20;
            margin-bottom: 40px;
        }

        .checkout-title {
            font-family: 'Playfair Display', serif;
            font-weight: 700;
            font-size: 2.5rem;
            margin: 0;
        }

        .checkout-item-img {
            width: 80px;
            height: 100px;
            object-fit: cover;
            border-radius: 8px;
        }

        .section-header {
            font-family: 'Playfair Display', serif;
            font-weight: 700;
            font-size: 1.25rem;
            margin-bottom: 15px;
        }

        .info-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #eee;
            cursor: pointer;
        }

        .info-row:last-child {
            border-bottom: none;
        }

        .info-label {
            font-weight: 600;
        }

        .info-value {
            color: #666;
        }

        .summary-box {
            background-color: #FFF9F5;
            /* Light beige bg */
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .checkout-btn {
            background-color: #E8C3BC;
            /* Pink button */
            border: none;
            color: #fff;
            color: #333;
            /* Darker text for contrast on light button */
            font-weight: 600;
            padding: 15px;
            border-radius: 8px;
            width: 100%;
            font-size: 1.1rem;
            transition: all 0.3s;
        }

        .checkout-btn:hover {
            background-color: #D4A59A;
        }

        .arrow-icon {
            color: #333;
        }

        .quantity-control {
            border: 1px solid #ddd;
            border-radius: 4px;
            display: inline-flex;
            align-items: center;
        }

        .quantity-btn {
            border: none;
            background: none;
            padding: 2px 10px;
        }

        .quantity-display {
            padding: 2px 10px;
            border-left: 1px solid #ddd;
            border-right: 1px solid #ddd;
        }
    </style>
</head>

<body>

    <header id="navMount"></header>

    <!-- Header Section -->
    <div class="checkout-header" style="margin-top: 70px;">
        <h1 class="checkout-title">Checkout</h1>
        <!-- Or "Order Summary" -->
    </div>

    <div class="container main-content" style="max-width: 800px;">

        <form th:action="@{/checkout/place}" method="POST">
            <input type="hidden" name="addressId" th:value="${shippingAddress != null ? shippingAddress.id : ''}">
            <input type="hidden" name="payment_method" th:value="${paymentMethodValue}">

            <!-- Product List -->
            <div class="mb-5">
                <div th:each="item : ${cart.items}" class="d-flex align-items-center mb-4">
                    <img th:src="@{${item.product.imageUrl}}" alt="Product" class="checkout-item-img me-3">
                    <div class="flex-grow-1">
                        <h5 class="mb-1" style="font-family: 'Playfair Display', serif;" th:text="${item.product.name}">
                            Product Name</h5>
                        <p class="mb-2"
                            th:text="${'Rp. ' + #numbers.formatDecimal(item.product.price, 0, 'POINT', 2, 'COMMA')}">Rp.
                            250.000,00</p>
                    </div>
                    <div class="quantity-control px-2">
                        <!-- Static quantity for now or minimal control -->
                        <span th:text="${item.quantity}">1</span>
                    </div>
                </div>
            </div>

            <!-- Shipping To Section -->
            <div class="mb-4">
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <h4 class="section-header mb-0">Shipping to</h4>
                    <a th:href="@{/checkout/address}" class="text-decoration-none text-dark d-flex align-items-center">
                        <span class="me-2"
                            th:text="${shippingAddress != null ? (shippingAddress.recipientName + ' (' + shippingAddress.addressType + ')') : 'Select Address'}">House</span>
                        <i class="fas fa-chevron-right arrow-icon"></i>
                    </a>
                </div>
                <!-- Address Details (Hidden input used above) -->
            </div>

            <!-- Summary Box -->
            <div class="summary-box">
                <h4 class="section-header">Subtotal product</h4>
                <hr>
                <div class="d-flex justify-content-between mb-2">
                    <span><span th:text="${#lists.size(cart.items)}">1</span> Product</span>
                    <span th:text="${'Rp. ' + #numbers.formatDecimal(total, 0, 'POINT', 2, 'COMMA')}">Rp.
                        250.000,00</span>
                </div>
                <div class="d-flex justify-content-between mb-2">
                    <span>Discount</span>
                    <span>Rp. 0,00</span>
                </div>
                <div class="d-flex justify-content-between mb-2">
                    <span>Shipping fee</span>
                    <span>Rp. 0,00</span>
                </div>
                <hr>
                <div class="d-flex justify-content-between font-weight-bold">
                    <strong>Total</strong>
                    <strong th:text="${'Rp. ' + #numbers.formatDecimal(total, 0, 'POINT', 2, 'COMMA')}">Rp.
                        250.000,00</strong>
                </div>
            </div>

            <!-- Payment Method Section -->
            <div class="mb-5">
                <div class="d-flex justify-content-between align-items-center">
                    <h4 class="section-header mb-0">Payment method</h4>
                    <a th:href="@{/checkout/payment(addressId=${shippingAddress != null ? shippingAddress.id : ''})}"
                        class="text-decoration-none text-dark d-flex align-items-center">
                        <span class="me-2" th:text="${paymentMethodName}">Cash on Delivery</span>
                        <i class="fas fa-chevron-right arrow-icon"></i>
                    </a>
                </div>
            </div>

            <!-- Error Message -->
            <div th:if="${param.error}" class="alert alert-danger">
                <span th:text="${param.error}">Error</span>
            </div>

            <!-- Checkout Button -->
            <button type="submit" class="checkout-btn mb-5">Check out</button>

        </form>
    </div>

    <!-- Simple Footer -->
    <footer class="text-center py-4" style="background-color: #1D1B20; color: #fff;">
        <p class="mb-0">Â© 2025 MINARI. All Rights Reserved.</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script th:src="@{/js/navbar.js}"></script>
    <script th:inline="javascript">
        /*<![CDATA[*/
        window.APP_ROLE = /*[[${#authorization.expression('isAuthenticated()') ? 'user' : 'guest'}]]*/ 'guest';
        /*]]>*/
    </script>
</body>

</html>