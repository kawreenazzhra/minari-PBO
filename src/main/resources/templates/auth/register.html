<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.thymeleaf.org"
      layout:decorate="~{layout}">
<head>
    <title>Register - Minari E-Commerce</title>
</head>
<body>
    <div layout:fragment="content">
        <div class="container py-5">
            <div class="row justify-content-center">
                <div class="col-md-8 col-lg-6">
                    <div class="card border-0 shadow-sm">
                        <div class="card-body p-4">
                            <!-- Header -->
                            <div class="text-center mb-4">
                                <h2 class="h3 mb-2">Create Account</h2>
                                <p class="text-muted">Join MINARI and start shopping today</p>
                            </div>

                            <!-- Error Messages -->
                            <div th:if="${#fields.hasErrors('global')}" class="alert alert-danger alert-dismissible fade show" role="alert">
                                <i class="fas fa-exclamation-triangle me-2"></i>
                                <span th:each="error : ${#fields.errors('global')}" th:text="${error}"></span>
                                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                            </div>

                            <!-- Registration Form -->
                            <form th:action="@{/register}" method="post" th:object="${user}" novalidate>
                                <div class="row">
                                    <!-- First Name -->
                                    <div class="col-md-6 mb-3">
                                        <label for="firstName" class="form-label">First Name *</label>
                                        <input type="text"
                                               class="form-control"
                                               id="firstName"
                                               th:field="*{firstName}"
                                               placeholder="Enter your first name"
                                               required>
                                        <div class="invalid-feedback" th:if="${#fields.hasErrors('firstName')}" th:errors="*{firstName}"></div>
                                    </div>

                                    <!-- Last Name -->
                                    <div class="col-md-6 mb-3">
                                        <label for="lastName" class="form-label">Last Name *</label>
                                        <input type="text"
                                               class="form-control"
                                               id="lastName"
                                               th:field="*{lastName}"
                                               placeholder="Enter your last name"
                                               required>
                                        <div class="invalid-feedback" th:if="${#fields.hasErrors('lastName')}" th:errors="*{lastName}"></div>
                                    </div>
                                </div>

                                <!-- Email -->
                                <div class="mb-3">
                                    <label for="email" class="form-label">Email Address *</label>
                                    <div class="input-group">
                                        <span class="input-group-text"><i class="fas fa-envelope"></i></span>
                                        <input type="email"
                                               class="form-control"
                                               id="email"
                                               th:field="*{email}"
                                               placeholder="Enter your email"
                                               required
                                               autocomplete="email">
                                    </div>
                                    <div class="invalid-feedback" th:if="${#fields.hasErrors('email')}" th:errors="*{email}"></div>
                                    <div class="form-text">We'll never share your email with anyone else.</div>
                                </div>

                                <!-- Phone -->
                                <div class="mb-3">
                                    <label for="phone" class="form-label">Phone Number</label>
                                    <div class="input-group">
                                        <span class="input-group-text"><i class="fas fa-phone"></i></span>
                                        <input type="tel"
                                               class="form-control"
                                               id="phone"
                                               th:field="*{phone}"
                                               placeholder="Enter your phone number"
                                               autocomplete="tel">
                                    </div>
                                    <div class="invalid-feedback" th:if="${#fields.hasErrors('phone')}" th:errors="*{phone}"></div>
                                </div>

                                <!-- Password -->
                                <div class="mb-3">
                                    <label for="password" class="form-label">Password *</label>
                                    <div class="input-group">
                                        <span class="input-group-text"><i class="fas fa-lock"></i></span>
                                        <input type="password"
                                               class="form-control"
                                               id="password"
                                               th:field="*{password}"
                                               placeholder="Create a password"
                                               minlength="8"
                                               required
                                               autocomplete="new-password">
                                    </div>
                                    <div class="invalid-feedback" th:if="${#fields.hasErrors('password')}" th:errors="*{password}"></div>
                                    <div class="form-text">
                                        Password must be at least 8 characters long and contain uppercase, lowercase, and numbers.
                                    </div>
                                </div>

                                <!-- Confirm Password -->
                                <div class="mb-3">
                                    <label for="confirmPassword" class="form-label">Confirm Password *</label>
                                    <div class="input-group">
                                        <span class="input-group-text"><i class="fas fa-lock"></i></span>
                                        <input type="password"
                                               class="form-control"
                                               id="confirmPassword"
                                               name="confirmPassword"
                                               placeholder="Confirm your password"
                                               required
                                               autocomplete="new-password">
                                    </div>
                                    <div class="invalid-feedback">
                                        Passwords do not match.
                                    </div>
                                </div>

                                <!-- Terms and Conditions -->
                                <div class="mb-3">
                                    <div class="form-check">
                                        <input class="form-check-input"
                                               type="checkbox"
                                               id="terms"
                                               name="terms"
                                               required>
                                        <label class="form-check-label" for="terms">
                                            I agree to the <a href="/terms" target="_blank">Terms of Service</a> and <a href="/privacy" target="_blank">Privacy Policy</a> *
                                        </label>
                                        <div class="invalid-feedback">
                                            You must agree to the terms and conditions.
                                        </div>
                                    </div>
                                </div>

                                <!-- Newsletter Subscription -->
                                <div class="mb-4">
                                    <div class="form-check">
                                        <input class="form-check-input"
                                               type="checkbox"
                                               id="newsletter"
                                               name="newsletter"
                                               checked>
                                        <label class="form-check-label" for="newsletter">
                                            Subscribe to our newsletter for exclusive deals and updates
                                        </label>
                                    </div>
                                </div>

                                <!-- Submit Button -->
                                <div class="d-grid mb-3">
                                    <button type="submit" class="btn btn-primary btn-lg">
                                        <i class="fas fa-user-plus me-2"></i>Create Account
                                    </button>
                                </div>
                            </form>

                            <!-- Social Registration Options -->
                            <div class="text-center mb-3">
                                <div class="divider">
                                    <span class="divider-text">or sign up with</span>
                                </div>
                            </div>

                            <div class="d-grid gap-2 mb-4">
                                <button class="btn btn-outline-secondary">
                                    <i class="fab fa-google me-2"></i>Continue with Google
                                </button>
                                <button class="btn btn-outline-secondary">
                                    <i class="fab fa-facebook-f me-2"></i>Continue with Facebook
                                </button>
                            </div>

                            <!-- Login Link -->
                            <div class="text-center">
                                <p class="mb-0">Already have an account?
                                    <a href="/login" class="text-decoration-none fw-bold">Sign in here</a>
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Benefits -->
                    <div class="row mt-4">
                        <div class="col-md-4 text-center mb-3">
                            <i class="fas fa-shipping-fast fa-2x text-primary mb-2"></i>
                            <h6>Free Shipping</h6>
                            <small class="text-muted">On orders over Rp 500,000</small>
                        </div>
                        <div class="col-md-4 text-center mb-3">
                            <i class="fas fa-undo fa-2x text-success mb-2"></i>
                            <h6>Easy Returns</h6>
                            <small class="text-muted">30-day return policy</small>
                        </div>
                        <div class="col-md-4 text-center mb-3">
                            <i class="fas fa-headset fa-2x text-info mb-2"></i>
                            <h6>24/7 Support</h6>
                            <small class="text-muted">Customer service always ready</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div layout:fragment="scripts">
        <script>
            // Password confirmation validation
            document.addEventListener('DOMContentLoaded', function() {
                const form = document.querySelector('form');
                const password = document.getElementById('password');
                const confirmPassword = document.getElementById('confirmPassword');

                function validatePassword() {
                    if (password.value !== confirmPassword.value) {
                        confirmPassword.setCustomValidity('Passwords do not match');
                    } else {
                        confirmPassword.setCustomValidity('');
                    }
                }

                password.addEventListener('input', validatePassword);
                confirmPassword.addEventListener('input', validatePassword);

                // Form validation
                form.addEventListener('submit', function(event) {
                    if (!form.checkValidity()) {
                        event.preventDefault();
                        event.stopPropagation();
                    }
                    form.classList.add('was-validated');
                });

                // Password strength indicator
                password.addEventListener('input', function() {
                    const strength = calculatePasswordStrength(this.value);
                    updatePasswordStrengthIndicator(strength);
                });
            });

            function calculatePasswordStrength(password) {
                let strength = 0;
                if (password.length >= 8) strength++;
                if (/[a-z]/.test(password)) strength++;
                if (/[A-Z]/.test(password)) strength++;
                if (/[0-9]/.test(password)) strength++;
                if (/[^A-Za-z0-9]/.test(password)) strength++;
                return strength;
            }

            function updatePasswordStrengthIndicator(strength) {
                const indicator = document.querySelector('.password-strength');
                if (!indicator) return;

                const labels = ['Very Weak', 'Weak', 'Fair', 'Good', 'Strong'];
                const colors = ['danger', 'warning', 'info', 'primary', 'success'];

                indicator.textContent = labels[strength - 1] || '';
                indicator.className = `password-strength text-${colors[strength - 1] || 'muted'}`;
            }
        </script>
    </div>

    <style>
        .divider {
            position: relative;
            margin: 1rem 0;
        }

        .divider::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background-color: #dee2e6;
        }

        .divider-text {
            background-color: white;
            padding: 0 1rem;
            color: #6c757d;
            font-size: 0.875rem;
        }

        .password-strength {
            font-size: 0.75rem;
            margin-top: 0.25rem;
        }
    </style>
</body>
</html>

